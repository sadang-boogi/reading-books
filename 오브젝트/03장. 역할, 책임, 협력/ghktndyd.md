# 03. 역할, 책임, 협력

> 객체지향에서 가장 중요한 것은 결국 **역할, 책임 협력**

- 객체를 자율적으로 만드는 가장 기본적인 방법이 **캡슐화**이다.

#### 정리

- 객체가 책임을 수행 중 필요한 정보나 도움이 필요한 경우 **적절한 객체에게 메세지 전송으로 협력을 요청**한다.
- 메세지를 수신한 객체도 처리 중 스스로 해결하지 못하는 영역은 협력을 통해서 해결한다.

## 협력

### 협력이 설계를 위한 문맥을 결정한다.

- 객체의 행동을 결정하는 것은 **객체가 참여하고 있는 협력**이다.
- **상태**는 객체가 행동할 때 필요한 정보에 의해서 결정
- **행동**은 객체가 처리할 메세지
- 결과적으로 협력이 객체의 상태와 행동을 결정
- 즉, 협력은 객체를 설계하는 데 필요한 **문맥(context)**을 제공한다.

## 책임

### 책임이란 무엇인가

- 협력이 결정된 뒤에는 협력에 필요한 행동을 수행할 수 있는 적절한 객체를 찾는 것이다.
- 객체가 수행하는 행동을 **책임**이라고 한다.
- **책임이란** 객체에 의해 정의되는 응집도 있는 행위의 집합으로 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장이다.
- 즉 책임은 아래 두 가지로 구성된다.
    1. 무엇을 알고있는가? (아는 것)
    2. 무엇을 할 수 있는가? (하는 것)

##### 아는 것

1. 사적인 정보에 관해서 아는 것
2. 관련된 객체에 관해 아는 것
3. 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

#### 하는 것

1. 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
2. 다른 객체의 행동을 시작시키는 것
3. 다른 객체의 활동을 제어하고 조절하는 것

> `Screening`은 영화 예매를 할 수 있어야 한다.
> ➡️ 하는 것
>
> `Screening`은 자신이 상영할 영화를 알아야 한다.
> ➡️ 아는 것

- `Movie`가 `calculateMovieFee` 라는 메세지를 수신할 수 있고, `fee(금액)`과 `discountPolicy(할인정책)`을 필드로 가지는 이유는 협력 안에서 금액을 계산할 책임을 할당
  받았기 때문이다.
- 위처럼 **협력 안에서 객체에게 할당된 책임이 외부의 인터페이스와 내부의 속성을 결정한다.**

### 책임-주도 설계로 설계하기

1. 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
   영화 예매 시스템이면 **예매를 해야 한다.** 가 시스템 책임

2. 시스템 책임을 더 작은 책임으로 분할한다.
   예매를 하려면 가격을 알아야 하니까 **가격을 계산하라** 라는 책임으로 분할

3. 분할된 책임을 수행할 수 있는 적절한 객체에게 책임을 할당한다.
   가격을 계산하는 책임은 **영화의 가격을 아는 `Movie`가 하자!**

4. 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 객체를 찾는다.
   가격은 `Movie`가 잘 알지만 **할인 가격을 계산하는 건 `discountPolicy`** 가 더 잘할 거 같아..

5. 해당 객체와 책임을 할당함으로써 두 객체가 협력하게 한다.

### 메세지가 객체를 결정한다.

- 메세지가 객체를 선택하게 해야 하는 2가지 이유

1. 객체가 **최소한의 인터페이스**를 가질 수 있게 된다.
   필요한 메세지가 식별될 때까지 객체의 퍼블릭 인터페이스에는 어떤 것도 추가하지 않는다.
   때문에 객체는 애플리케이션에 크지도, 작지도 않은 적당한 크기의 퍼블릭 인터페이스를 가질 수 있다.

2. 객체는 충분히 **추상적인 인터페이스**를 가질 수 있게 된다.
   객체의 인터페이스는 **무엇을 하는지를 표현**해야 하지만 **어떻게 수행하는지는 노출하면 안된다.**
   **메세지는 외부의 객체가 요청하는 무엇**이기 때문에 무엇을 수행할지에 초점을 맞추는 인터페이스를 얻을 수 있다.

#### **역할의 구현**

- 역할을 구현하는 가장 일반적인 방법은 **추상 클래스**와 **인터페이스**다.
- **추상클래스와 인터페이스**는 협력 관점에서 구체 클래스들이 따라야 하는 책임의 집합이다.
- **추상클래스와 인터페이스**는 동일한 책임을 수행하는 다양한 종류의 클래스들을 협력에 참여시킬 수 있는 확장 포인트를 제공한다.

#### 역할

![Pasted image 20240429150011](https://github.com/ghktndyd/TIL/assets/120021021/d4a90708-3c6d-4bcd-aeb8-4ffa2ee9136c)

### 객체 대 역할

- 협력에 참여하는 후보가 여러 종류의 객체라면 **후보는 역할이 된다.**
- 협력에 참여하는 후보가 단지 한 종류의 객체라면 **후보는 객체가 된다.**

#### 협력, 역할, 객체, 클래스의 관계

> 협력 **-- `(reference)` ->** 역할 **-- `(select from)` ->**  객체 **-- `(instance of)` ->** 클래스

### 역할과 추상화

- 추상화의 장점
    1. 세부 사항에 억눌리지 않고 상위 수준의 정책을 표현 가능하다.
    2. 설계를 유연하게 한다.

### 배우와 배역

- 배역은 연극 배우가 특정 연극에서 연기하는 역할이다.
- 배역은 연국이 상영되는 동안에만 존재하는 일시적인 개념이다.
- 연극이 끝나면 연극 배우는 배역이라는 역할을 벗어 버리고 원래의 연극 배우로 돌아온다.
- 서로 다은 배우들이 동일한 배역을 연기할 수 있다.
- 하나의 배우가 다양한 연극 안에서 다른 배역을 연기할 수 있다.

1. **연극은 하나의 협력이다.**
2. **배역을 역할이다.**
3. **배우는 객체다.**

